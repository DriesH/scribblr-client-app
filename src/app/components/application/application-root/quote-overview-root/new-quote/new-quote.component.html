<div id="new-quote-overlay" #dropzone>
    <a class="close-cross" routerLink="../">
        <img src="/assets/icons/cross.svg">
    </a>

    <div class="new-quote--container">
        <div class="form--container">
            <form (ngSubmit)="addNewQuote(previewCanvas)" #newQuoteForm="ngForm">
                <div class="form-input-group">
                    <label for="name">Quote<span style="color:red">*</span></label>
                    <input type="text"
                        name="quote"
                        id="quote"
                        #quote="ngModel"
                        [(ngModel)]="quoteModel.quote"
                        (keyup)="updateCanvasOnKeyup()"
                        (change)="updateCanvasOnChange()"
                        autofocus
                        required
                    >

                    <scrblr-form-error *ngIf="quote.errors && (quote.dirty || quote.touched)"
                        [model]="quote"
                        [modelName]="'Quote'">
                    </scrblr-form-error>
                </div>

                <div class="form-input-group">
                    <label for="font">Font</label>
                    <select id="font" name="font" #font="ngModel" [(ngModel)]="quoteModel.font" (change)="updateCanvasOnChange()" required>
                        <option *ngFor="let font of fonts" [value]="font">{{ font }}</option>
                    </select>

                    <scrblr-form-error *ngIf="font.errors && (font.dirty ||font.touched)"
                        [model]="font"
                        [modelName]="'Font'">
                    </scrblr-form-error>
                </div>

                <button type="submit" class="btn btn-primary btn-color-main" [disabled]="!newQuoteForm.valid">New</button>

            </form>
        </div>

        <div class="new-quote-preview--container">
            <div class="canvas--container">
                <div class="loading-spinner--container" *ngIf="canvasLoading">
                    <span class="loading-spinner"></span>
                    <p>Loading...</p>
                </div>
                <canvas id="preview-canvas" class="canvas-style" #previewCanvas></canvas>
            </div>

            <div class="switch--container">

                <div class="switch-button-text" [ngClass]="{ 'selected' : presetPickerActive }">
                    <p>Select a preset image.</p>
                </div>

                <label class="switch-btn">
                    <input type="checkbox" (change)="toggleImageMode()">
                    <div class="slider round"></div>
                </label>

                <div class="switch-button-text" [ngClass]="{ 'selected' : !presetPickerActive }">
                    <p>Upload my own image.</p>
                </div>

            </div>

            <ul class="preset-picker" *ngIf="presetPickerActive" perfect-scrollbar>
                <input class='pexels-search' (keyup)='searchPexelsApi(searchQuery)' [(ngModel)]="searchQuery" type="text" name="search" value="" placeholder="Type in a keyword to search for pictures...">
                <li class="preset" *ngFor="let img of pexelsImgs" (click)="changeImage($event, img.src.large)">
                    <img [src]="img.src.tiny" [alt]="img.photographer">
                </li>
            </ul>

            <img [src]="quoteModel.selectedPreset" id="presetImg" #presetImg (load)="initCanvas(presetImg, previewCanvas, '40')" *ngIf="presetPickerActive">

            <img src="" [hidden]="presetPickerActive" id="userImg" #userImg (load)="startAviary()" cross-origin="anonymous">

        </div>
    </div>
</div>
